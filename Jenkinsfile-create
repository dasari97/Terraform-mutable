pipeline {
    agent any
    
    stages {
        stage ('VPC') {
            steps {
                 sh ''' 
                        cd VPC
                        make dev
                     '''
             }
                 
        }
        
        stage ('Databases_Create') {
            steps {
                     sh ''' 
                        cd Databases
                        make dev
                     '''
             }
                 
        }
        
        stage ('LB_Create') {
            steps {
                     sh ''' 
                        cd ALB
                        make dev
                     '''
             }
                 
        }
        
        stage ('APP_create') {
             parallel {
                 stage ('cart') {
                     steps {
                         dir('cart') {
                             sh ''' 
                                git clone https://dasarisaikrishna97@dev.azure.com/dasarisaikrishna97/Roboshop/_git/cart .
                                cd Terraform-Mutable
                                make dev
                             '''
                         }
                     }
                 }
                
               stage ('catalogue') {
                     steps {
                         dir('catalogue') {
                             sh ''' 
                                git clone https://dasarisaikrishna97@dev.azure.com/dasarisaikrishna97/Roboshop/_git/catalogue .
                                cd Terraform-Mutable
                                make dev
                             '''
                         }
                     }
                 }
                 
                 stage ('user') {
                     steps {
                         dir('user') {
                             sh ''' 
                                git clone https://dasarisaikrishna97@dev.azure.com/dasarisaikrishna97/Roboshop/_git/user .
                                cd Terraform-Mutable
                                make dev
                             '''
                         }
                     }
                 }
                 
                 stage ('shipping') {
                     steps {
                         dir('shipping') {
                             sh ''' 
                                git clone https://dasarisaikrishna97@dev.azure.com/dasarisaikrishna97/Roboshop/_git/shipping .
                                cd Terraform-Mutable
                                make dev
                             '''
                         }
                     }
                 }
                 
                 stage ('payment') {
                     steps {
                         dir('payment') {
                             sh ''' 
                                git clone https://dasarisaikrishna97@dev.azure.com/dasarisaikrishna97/Roboshop/_git/payment .
                                cd Terraform-Mutable
                                make dev
                             '''
                         }
                     }
                 }
          }
    }
    
    stage ('frontend') {
         steps {
             dir('frontend') {
                 sh ''' 
                    git clone https://dasarisaikrishna97@dev.azure.com/dasarisaikrishna97/Roboshop/_git/frontend .
                    cd Terraform-Mutable
                    make dev
                 '''
                 }
             }
         }
    }   
    post {
        always {
            cleanWs()
        }
    }
}